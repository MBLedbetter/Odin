
DROP PROCEDURE Odin_InsertBuItemsInv
GO


SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE Odin_InsertBuItemsInv(
	@businessUnit varchar(5)='',
	@itemId varchar(18) ='',
	@COO varchar(3)='',
	@mfg varchar(2)='',
	@dac varchar(9)=''
	)

AS
BEGIN

	SET NOCOUNT ON;
	
	IF NOT EXISTS (SELECT * FROM PS_BU_ITEMS_INV 
                   WHERE INV_ITEM_ID = @itemId
                   AND BUSINESS_UNIT = @businessUnit)
		   BEGIN
			   INSERT INTO PS_BU_ITEMS_INV(
			BUSINESS_UNIT,
			INV_ITEM_ID,
			ITM_STATUS_EFFDT,
			ITM_STATUS_CURRENT,
			ITM_STAT_DT_FUTURE,
			ITM_STATUS_FUTURE,
			LAST_ADJUSTMENT,
			LAST_ORDER,
			LAST_ORDER_DATE,
			LAST_PUTAWAY_DATE,
			QTY_AVAILABLE,
			QTY_RESERVED,
			QTY_OWNED,
			QTY_ONHAND,
			LAST_DEMAND_CALC,
			LAST_MO_DEMAND,
			LAST_QTR_DEMAND,
			LAST_2QTR_DEMAND,
			LAST_ANNUAL_DEMAND,
			LAST_UD_DEMAND,
			LAST_DEMAND_DATE,
			REPLENISH_CLASS,
			REPL_CALC_PERIOD,
			REPLENISH_LEAD,
			HISTORICAL_LEAD,
			PROJECTED_LEAD,
			SAFETY_STOCK,
			STOCKOUT_RATE,
			REORDER_POINT,
			REORDER_QTY,
			QTY_IUT_PAR,
			EOQ,
			AOQ,
			FOQ,
			QTY_MAXIMUM,
			DAYS_SUPPLY,
			ORDER_MULTIPLE,
			SAFETY_LEAD_TIME,
			TARGET_LEVEL,
			EXCESS_BU,
			LAST_ISS_EXCESS,
			USE_UP_QOH,
			INSPECT_TIME,
			DOCK_TO_STOCK,
			COST_ELEMENT,
			COST_GROUP_CD,
			LAST_CYCLE_COUNT,
			LAST_PIT_COUNT,
			LAST_UTIL_REVIEW,
			NEXT_UTIL_REVIEW,
			RELATED_ITEM_ID,
			ROPC_INSTANCE,
			ROPC_STATUS,
			SSTC_INSTANCE,
			SSTC_STATUS,
			EOQC_INSTANCE,
			EOQC_STATUS,
			HLDC_INSTANCE,
			HLDC_STATUS,
			ANNDM_INSTANCE,
			ANNDM_STATUS,
			CYCLE_INSTANCE,
			NO_REPLENISH_FLG,
			SOURCE_CODE,
			PHANTOM_ITEM_FLAG,
			BOM_USAGE,
			DT_TIMESTAMP,
			LAST_PRICE_PAID,
			AVERAGE_COST,
			AVERAGE_COST_MAT,
			CURRENT_COST,
			DFLT_ACTUAL_COST,
			EXCESS_INVENTORY,
			REVISION_CONTROL,
			EN_AUTO_REV,
			ISSUE_METHOD,
			STAGED_DATE_FLAG,
			ISSUE_MULTIPLE,
			REPLENISH_POINT,
			WIP_MIN_QTY,
			IP_PLANNING_FLG,
			PLANNER_CD,
			YIELD_CALC_FLG,
			PRDN_AREA_CODE,
			TRANSIT_COST_TYP,
			UOM_CONV_FLAG,
			MASTER_RTG_OPT,
			REF_ROUTING_ITEM,
			STD_PACK_UOM,
			FORECAST_ITEM_FLAG,
			FORECASTER,
			COUNTRY_IST_ORIGIN,
			IST_REGION_ORIGIN,
			TRANSFER_MIN_ORDER,
			TRANSFER_YIELD,
			NON_OWN_FLAG,
			INV_STOCK_TYPE,
			SHIP_TYPE_ID,
			ISOLATE_ITEM_FLG,
			INVENTORY_ITEM,
			MG_PRDN_OPTION,
			MG_VALID_PRDN_OPT,
			MG_ASSOCIATED_BOM,
			SHELF_LIFE,
			AVAIL_LEAD_TIME,
			RETEST_LEAD_TIME,
			MATERIAL_RECON_FLG,
			USG_TRCKNG_METHOD,
			CHARGE_MARKUP_PCNT,
			CHARGE_MARKUP_AMT,
			CHARGE_CODE,
			MFG_COSTED_FLAG,
			CONSIGNED_FLAG,
			VENDOR_ID,
			VNDR_LOC,
			BOM_CODE,
			RTG_CODE,
			MFG_LEADTIME_F,
			MFG_LEADTIME_V,
			MFG_LTRATEF,
			MFG_LTRATEV,
			OVERSIZED,
			ADD_HANDLING,
			ITEM_FIELD_C30_A,
			ITEM_FIELD_C30_B,
			ITEM_FIELD_C30_C,
			ITEM_FIELD_C30_D,
			ITEM_FIELD_C1_A,
			ITEM_FIELD_C1_B,
			ITEM_FIELD_C1_C,
			ITEM_FIELD_C1_D,
			ITEM_FIELD_C10_A,
			ITEM_FIELD_C10_B,
			ITEM_FIELD_C10_C,
			ITEM_FIELD_C10_D,
			ITEM_FIELD_C2,
			ITEM_FIELD_C4,
			ITEM_FIELD_C6,
			ITEM_FIELD_C8,
			ITEM_FIELD_N12_A,
			ITEM_FIELD_N12_B,
			ITEM_FIELD_N12_C,
			ITEM_FIELD_N12_D,
			ITEM_FIELD_N15_A,
			ITEM_FIELD_N15_B,
			ITEM_FIELD_N15_C,
			ITEM_FIELD_N15_D,
			EXPORTER_ECCN,
			EXPORT_LIC_NBR,
			INCL_WIP_QTY_FLG,
			DECLARED_VALUE,
			SF_WIP_MAX_QTY,
			SF_RPL_MODE,
			SF_RPL_SOURCE,
			SF_RPL_METHOD,
			SF_RPL_TYPE,
			SF_DISPATCH_MODE,
			SF_RPL_STOR_AREA,
			SF_RPL_STOR_LEV1,
			SF_RPL_STOR_LEV2,
			SF_RPL_STOR_LEV3,
			SF_RPL_STOR_LEV4,
			SF_RPL_VENDOR_ID,
			SF_RPL_VNDR_LOC,
			SF_RPL_PRDN_AREA,
			DP_PUBLISH_DATE,
			DP_POLICYSET,
			DP_POLICYCONTROL,
			DP_PUBLISHNAME
	)
	VALUES(
			@businessUnit,	--BUSINESS_UNIT,
			@itemId,		--INV_ITEM_ID,
			GETDATE(),		--ITM_STATUS_EFFDT,
			'1',			--ITM_STATUS_CURRENT,
			NULL,			--ITM_STAT_DT_FUTURE,
			'',				--ITM_STATUS_FUTURE,
			NULL,			--LAST_ADJUSTMENT,
			'',				--LAST_ORDER,
			NULL,			--LAST_ORDER_DATE,
			NULL,			--LAST_PUTAWAY_DATE,
			0.0000,			--QTY_AVAILABLE,
			0.0000,			--QTY_RESERVED,
			0.0000,			--QTY_OWNED,
			0.0000,			--QTY_ONHAND,
			'',				--LAST_DEMAND_CALC,
			0.0000,			--LAST_MO_DEMAND,
			0.0000,			--LAST_QTR_DEMAND,
			0.0000,			--LAST_2QTR_DEMAND,
			0.0000,			--LAST_ANNUAL_DEMAND,
			0.0000,			--LAST_UD_DEMAND,
			NULL,			--LAST_DEMAND_DATE,
			'',				--REPLENISH_CLASS,
			365,			--REPL_CALC_PERIOD,
			0.00,			--REPLENISH_LEAD,
			0.00,			--HISTORICAL_LEAD,
			0.00,			--PROJECTED_LEAD,
			0.0000,			--SAFETY_STOCK,
			95.0,			--STOCKOUT_RATE,
			0.0000,			--REORDER_POINT,
			0.0000,			--REORDER_QTY,
			0.0000,			--QTY_IUT_PAR,
			0.0000,			--EOQ,
			1.0000,			--AOQ,
			0.0000,			--FOQ,
			0.0000,			--QTY_MAXIMUM,
			0.0000,			--DAYS_SUPPLY,
			0,				--ORDER_MULTIPLE,
			0.0000,			--SAFETY_LEAD_TIME,
			0.0000,			--TARGET_LEVEL,
			'',				--EXCESS_BU,
			0,				--LAST_ISS_EXCESS,
			'N',			--USE_UP_QOH,
			0.0000,			--INSPECT_TIME,
			0.0000,			--DOCK_TO_STOCK,
			'100',			--COST_ELEMENT,
			'',				--COST_GROUP_CD,
			CONVERT(CHAR(10), GETDATE(), 121) ,--LAST_CYCLE_COUNT,
			NULL,			--LAST_PIT_COUNT,
			NULL,			--LAST_UTIL_REVIEW,
			NULL,			--NEXT_UTIL_REVIEW,
			'',				--RELATED_ITEM_ID,
			0,				--ROPC_INSTANCE,
			'1',			--ROPC_STATUS,
			0,				--SSTC_INSTANCE,
			'1',			--SSTC_STATUS,
			0,				--EOQC_INSTANCE,
			'1',			--EOQC_STATUS,
			0,				--HLDC_INSTANCE,
			'1',			--HLDC_STATUS,
			0,				--ANNDM_INSTANCE,
			'1',			--ANNDM_STATUS,
			0,				--CYCLE_INSTANCE,
			'Y',			--NO_REPLENISH_FLG,
			@mfg,			--SOURCE_CODE,
			'N',			--PHANTOM_ITEM_FLAG,
			'1',			--BOM_USAGE,
			GETDATE(),		--DT_TIMESTAMP,
			0.0000,			--LAST_PRICE_PAID,
			0.0000,			--AVERAGE_COST,
			0.0000,			--AVERAGE_COST_MAT,
			@dac,			--CURRENT_COST,
			@dac,			--DFLT_ACTUAL_COST,
			'N',			--EXCESS_INVENTORY,
			'N',			--REVISION_CONTROL,
			'N',			--EN_AUTO_REV,
			'ISS',			--ISSUE_METHOD,
			'N',			--STAGED_DATE_FLAG,
			1.0000,			--ISSUE_MULTIPLE,
			0.0000,			--REPLENISH_POINT,
			0.0000,			--WIP_MIN_QTY,
			'N',			--IP_PLANNING_FLG,
			'',				--PLANNER_CD,
			'N',			--YIELD_CALC_FLG,
			'',				--PRDN_AREA_CODE,
			'F',			--TRANSIT_COST_TYP,
			'0',			--UOM_CONV_FLAG,
			'ITM',			--MASTER_RTG_OPT,
			@itemId,		--REF_ROUTING_ITEM,
			'EA',			--STD_PACK_UOM,
			'N',			--FORECAST_ITEM_FLAG,
			'',				--FORECASTER,
			@COO,			--COUNTRY_IST_ORIGIN,
			'',				--IST_REGION_ORIGIN,
			0.0000,			--TRANSFER_MIN_ORDER,
			0.0,			--TRANSFER_YIELD,
			'N',			--NON_OWN_FLAG,
			'',				--INV_STOCK_TYPE,
			'',				--SHIP_TYPE_ID,
			'N',			--ISOLATE_ITEM_FLG,
			'Y',			--INVENTORY_ITEM,
			'01',			--MG_PRDN_OPTION,
			'N',			--MG_VALID_PRDN_OPT,
			@itemId,		--MG_ASSOCIATED_BOM,
			0,				--SHELF_LIFE,
			0,				--AVAIL_LEAD_TIME,
			0,				--RETEST_LEAD_TIME,
			'N',			--MATERIAL_RECON_FLG,
			'01',			--USG_TRCKNG_METHOD,
			0.00,			--CHARGE_MARKUP_PCNT,
			0.0000,			--CHARGE_MARKUP_AMT,
			'',				--CHARGE_CODE,
			'Y',			--MFG_COSTED_FLAG,
			'N',			--CONSIGNED_FLAG,
			'',				--VENDOR_ID,
			'',				--VNDR_LOC,
			0,				--BOM_CODE,
			0,				--RTG_CODE,
			0,				--MFG_LEADTIME_F,
			0,				--MFG_LEADTIME_V,
			'HR',			--MFG_LTRATEF,
			'HR',			--MFG_LTRATEV,
			'N',			--OVERSIZED,
			'N',			--ADD_HANDLING,
			'',				--ITEM_FIELD_C30_A,
			'',				--ITEM_FIELD_C30_B,
			'',				--ITEM_FIELD_C30_C,
			'',				--ITEM_FIELD_C30_D,
			'',				--ITEM_FIELD_C1_A,
			'',				--ITEM_FIELD_C1_B,
			'',				--ITEM_FIELD_C1_C,
			'',				--ITEM_FIELD_C1_D,
			'',				--ITEM_FIELD_C10_A,
			'',				--ITEM_FIELD_C10_B,
			'',				--ITEM_FIELD_C10_C,
			'',				--ITEM_FIELD_C10_D,
			'A',			--ITEM_FIELD_C2,
			'',				--ITEM_FIELD_C4,
			'',				--ITEM_FIELD_C6,
			'',				--ITEM_FIELD_C8,
			0.0000,			--ITEM_FIELD_N12_A,
			0.0000,			--ITEM_FIELD_N12_B,
			0.0000,			--ITEM_FIELD_N12_C,
			0.0000,			--ITEM_FIELD_N12_D,
			0,				--ITEM_FIELD_N15_A,
			0,				--ITEM_FIELD_N15_B,
			0,				--ITEM_FIELD_N15_C,
			0,				--ITEM_FIELD_N15_D,
			'',				--EXPORTER_ECCN,
			'',				--EXPORT_LIC_NBR,
			'N',			--INCL_WIP_QTY_FLG,
			0,				--DECLARED_VALUE,
			0.0000,			--SF_WIP_MAX_QTY,
			'1',			--SF_RPL_MODE,
			'1',			--SF_RPL_SOURCE,
			'3',			--SF_RPL_METHOD,
			'1',			--SF_RPL_TYPE,
			'',				--SF_DISPATCH_MODE,
			'',				--SF_RPL_STOR_AREA,
			'',				--SF_RPL_STOR_LEV1,
			'',				--SF_RPL_STOR_LEV2,
			'',				--SF_RPL_STOR_LEV3,
			'',				--SF_RPL_STOR_LEV4,
			'',				--SF_RPL_VENDOR_ID,
			'',				--SF_RPL_VNDR_LOC,
			'',				--SF_RPL_PRDN_AREA,
			NULL,			--DP_PUBLISH_DATE,
			'',				--DP_POLICYSET,
			'',				--DP_POLICYCONTROL,
			''				--DP_PUBLISHNAME
	)			
		   END
		   
	UPDATE PS_BU_ITEMS_INV
	SET
		COUNTRY_IST_ORIGIN = @COO,
		SOURCE_CODE = @mfg,
		CURRENT_COST = @dac,
		DFLT_ACTUAL_COST = @dac

	WHERE
		INV_ITEM_ID = @itemId 
		AND BUSINESS_UNIT = @businessUnit
		


END
GO

GRANT EXECUTE ON Odin_InsertBuItemsInv TO Odin
GO
/*
SELECT * FROM PS_BU_ITEMS_INV
sp_help PS_BU_ITEMS_INV
*/
